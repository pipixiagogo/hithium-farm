(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{K5Zc:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=l(a("bx4M"));a("2qtc");var o=l(a("kLXV")),i=l(a("jehZ"));a("g9YV");var c=l(a("wCAj"));a("5Dmo");var d=l(a("3S7+"));a("Pwec");var u=l(a("CtXQ"));a("DZo9");var f=l(a("8z0m"));a("+L6B");var s=l(a("2/Rp"));a("5NDa");var m=l(a("5rEg"));a("14J3");var p=l(a("BMrR"));a("jCWc");var y=l(a("kPKH"));a("miYZ");var h=l(a("tsqr"));a("P2fV");var v=l(a("NJEC"));a("/zsF");var E=l(a("PArb")),g=l(a("p0pE")),b=l(a("2Taf")),C=l(a("vZ4D")),w=l(a("l4Ni")),N=l(a("ujKo")),S=l(a("MhPg"));a("y8nQ");var L,F,k,x,D=l(a("Vl3Y")),z=n(a("q1tI")),V=a("MuoO"),M=l(a("zHco")),P=l(a("4MdG")),q=D.default.Item,T=(L=D.default.create(),F=(0,V.connect)(function(e){var t=e.company,a=e.loading;return{company:t,tableLoading:a.effects["company/getCompanyList"]}}),L(k=F((x=function(e){function t(){var e,a;(0,b.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,w.default)(this,(e=(0,N.default)(t)).call.apply(e,[this].concat(n))),a.state={searchData:{page:1,pageSize:10},visible:!1,info:null,dataList:[],dataVisible:""},a.getList=function(){var e=a.props.dispatch,t=a.state.searchData;e({type:"company/getCompanyList",payload:(0,g.default)({},t)})},a.showTotal=function(e,t){return z.default.createElement("span",null,"\u663e\u793a\u7b2c".concat(t[0],"\u5230\u7b2c ").concat(t[1]," \u6761\u8bb0\u5f55\uff0c\u603b\u5171 ").concat(e," \u6761\u8bb0\u5f55"))},a.handleReset=function(e){e.preventDefault();var t=a.props.form;t.resetFields(),a.handleSubmit(e)},a.handleTableChange=function(e){var t=a.state.searchData;a.setState({searchData:(0,g.default)({},t,{page:e.current,pageSize:e.pageSize})},function(){a.getList()})},a.handleSubmit=function(e){e.preventDefault();var t=a.props.form,l=a.state.searchData;t.validateFields(["factoryName"],function(e,t){if(!e){var n=(0,g.default)({},l,t,{page:1});a.setState({searchData:n},function(){a.getList()})}})},a.postFactoryName=function(){var e=a.state.info,t=a.props,l=t.form,n=t.dispatch;l.validateFields(["newFactoryName","newFactoryCode"],function(t,l){t||(e?n({type:"company/postFactoryName",payload:{factoryCode:l.newFactoryCode,newFactoryName:l.newFactoryName}}).then(function(e){1===e.code&&a.setState({info:null,visible:!1},function(){a.getList()})}):n({type:"company/addFactoryName",payload:{factoryCode:l.newFactoryCode,factoryName:l.newFactoryName}}).then(function(e){1===e.code&&a.setState({visible:!1},function(){a.getList()})}))})},a.delFactoryName=function(e){var t=a.props.dispatch;t({type:"company/delFactoryName",payload:{factoryCode:e}}).then(function(e){1===e.code&&a.getList()})},a}return(0,S.default)(t,e),(0,C.default)(t,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this,t=this.props,a=t.form.getFieldDecorator,l=t.tableLoading,n=t.company,b=t.dispatch,C=n.companyList,w=n.companyPage,N=this.state,S=N.visible,L=N.info,F=N.dataList,k=N.dataVisible,x={labelCol:{span:8},wrapperCol:{span:14}},V=[{title:"\u5e8f\u53f7",dataIndex:"id",width:100,render:function(e,t,a){return(w.current-1)*w.pageSize+a+1}},{title:"\u5382\u5546\u540d\u79f0",dataIndex:"factoryName"},{title:"\u5382\u5546\u7f16\u7801",render:function(e){return e.id}},{title:"\u64cd\u4f5c",render:function(t){return z.default.createElement("span",null,z.default.createElement("a",{onClick:function(){e.setState({info:t,visible:!0})}},"\u4fee\u6539"),z.default.createElement(E.default,{type:"vertical"}),z.default.createElement(v.default,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u5382\u5546\u4e48?",onConfirm:function(){e.delFactoryName(t.id)}},z.default.createElement("a",{href:"#"},"\u5220\u9664")))}}],T={action:"/factory/importFactoryWithExcel",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",name:"file",showUploadList:!1,headers:{token:localStorage.getItem("huihan-token")},beforeUpload:function(e){var t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel";return t||(h.default.error("\u6587\u4ef6\u683c\u5f0f\u9519\u8bef\uff0c\u5e94\u4e3aExcel\u6587\u4ef6!"),!1)},onChange:function(t){if("done"===t.file.status)if(t.file.response.code){var a=[];t.file.response.data.forEach(function(e){e.code||a.push(e)}),a.length?e.setState({dataList:a,dataVisible:"factory"}):(h.default.success("Excel\u5bfc\u5165\u6210\u529f\uff01"),b({type:"device/getSelectCompanyList"}),b({type:"device/saveList",payload:{datas:[],current:1,total:0,pageSize:1}}),e.getList())}else h.default.error(t.file.response.msg);else"error"===t.file.status&&h.default.error("\u4e0a\u4f20\u5931\u8d25")}},I=z.default.createElement("div",null,z.default.createElement("span",null,"Excel\u5bfc\u5165\u5382\u5546\u7684\u6761\u76ee\u4e0d\u5f97\u8d85\u8fc7200\u6761\uff0c\u683c\u5f0f\u4e3a\uff1a"),z.default.createElement(p.default,null,z.default.createElement(y.default,{span:10},"factoryCode"),z.default.createElement(y.default,{span:10},"factoryName")),z.default.createElement(p.default,{className:"mb-10"},z.default.createElement(y.default,{span:10},"factoryCode1"),z.default.createElement(y.default,{span:10},"factoryName1")),z.default.createElement("a",{href:"/static/factory.xlsx",style:{display:"inlineBlock",padding:"5px 10px",backgroundColor:"#3768E9",borderRadius:5},className:"white",target:"tempiframe"},"\u4e0b\u8f7d\u6a21\u677f"));return z.default.createElement(M.default,null,z.default.createElement(r.default,{bordered:!1,bodyStyle:{padding:0}},z.default.createElement(D.default,{layout:"inline",hideRequiredMark:!0,onSubmit:this.handleSubmit},z.default.createElement(q,null,a("factoryName")(z.default.createElement(m.default,{className:"wd-100",placeholder:"\u5382\u5546\u540d\u79f0"}))),z.default.createElement(q,null,z.default.createElement(s.default,{type:"primary",htmlType:"submit"},"\u641c\u7d22")),z.default.createElement(q,null,z.default.createElement(s.default,{onClick:this.handleReset},"\u91cd\u7f6e")),z.default.createElement("br",null),z.default.createElement(q,null,z.default.createElement(s.default,{type:"primary",onClick:function(){e.setState({visible:!0})}},"\u65b0\u589e")),z.default.createElement(q,null,z.default.createElement(f.default,T,z.default.createElement(s.default,{type:"primary"},"\u5bfc\u5165\u5382\u5546")),z.default.createElement(d.default,{placement:"bottom",title:I},z.default.createElement(u.default,{className:"ml-10",style:{fontSize:16},type:"question-circle",theme:"filled"})))),z.default.createElement(c.default,{className:"mt-20",rowKey:function(e){return e.id},dataSource:C,pagination:(0,g.default)({},w,{showSizeChanger:!0,showQuickJumper:!0,showTotal:this.showTotal}),columns:V,onChange:this.handleTableChange,loading:l}),z.default.createElement(o.default,{title:L?"\u4fee\u6539\u5382\u5546":"\u65b0\u589e\u5382\u5546",visible:S,onOk:this.postFactoryName,onCancel:function(){e.setState({info:null,visible:!1})},destroyOnClose:!0},z.default.createElement(D.default,null,z.default.createElement(q,(0,i.default)({},x,{label:"\u5382\u5546\u7f16\u7801"}),a("newFactoryCode",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5382\u5546\u7f16\u7801"}],initialValue:L&&L.id})(z.default.createElement(m.default,{disabled:!!L,placeholder:"\u8bf7\u8f93\u5165\u5382\u5546\u7f16\u7801"}))),z.default.createElement(q,(0,i.default)({},x,{label:"\u5382\u5546\u540d\u79f0"}),a("newFactoryName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5382\u5546\u540d\u79f0"}],initialValue:L&&L.factoryName})(z.default.createElement(m.default,{placeholder:"\u8bf7\u8f93\u5165\u5382\u5546\u540d\u79f0"}))))),z.default.createElement(P.default,(0,i.default)({},this.props,{dataVisible:k,dataList:F,handleCancle:function(){e.setState({dataVisible:"",dataList:[]})}}))))}}]),t}(z.PureComponent),k=x))||k)||k),I=T;t.default=I}}]);