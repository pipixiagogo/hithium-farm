(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[39],{"82CX":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=l(a("bx4M"));a("g9YV");var u=l(a("wCAj"));a("2qtc");var d=l(a("kLXV")),o=l(a("jehZ"));a("iQDF");var i=l(a("+eQT"));a("+L6B");var f=l(a("2/Rp"));a("5NDa");var c=l(a("5rEg"));a("/zsF");var s=l(a("PArb"));a("+BJd");var m=l(a("mr32")),p=l(a("p0pE")),h=l(a("2Taf")),b=l(a("vZ4D")),g=l(a("l4Ni")),v=l(a("ujKo")),T=l(a("MhPg"));a("OaEy");var E=l(a("2fM7"));a("y8nQ");var D,w,y,Y,M=l(a("Vl3Y")),C=n(a("q1tI")),S=a("MuoO"),k=l(a("wY1l")),F=l(a("wd/R")),L=l(a("zHco")),O=l(a("xNuS")),H=M.default.Item,R=E.default.Option,x=(D=M.default.create(),w=(0,S.connect)(function(e){var t=e.updateLog,a=e.loading;return{updateLog:t,tableLoading:a.effects["updateLog/getTableData"]}}),D(y=w((Y=function(e){function t(){var e,a;(0,h.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,g.default)(this,(e=(0,v.default)(t)).call.apply(e,[this].concat(n))),a.state={searchData:{type:"RDB",page:1,pageSize:10},tabKey:"RDB",showMore:!1,info:null,groupVisible:!1},a.getList=function(){var e=a.props.dispatch,t=a.state.searchData;e({type:"updateLog/getTableData",payload:(0,p.default)({},t)})},a.handleTabChange=function(e){a.setState({tabKey:e,searchData:{type:e,page:1,pageSize:10}},function(){a.getList()})},a.showTotal=function(e,t){return C.default.createElement("span",null,"\u663e\u793a\u7b2c".concat(t[0],"\u5230\u7b2c ").concat(t[1]," \u6761\u8bb0\u5f55\uff0c\u603b\u5171 ").concat(e," \u6761\u8bb0\u5f55"))},a.handleReset=function(e){e.preventDefault();var t=a.props.form;t.resetFields(),a.handleSubmit(e)},a.handleTableChange=function(e,t,l){var n=a.state.searchData,r=l.order&&l.columnKey||"",u=l.order?"descend"===l.order?-1:1:"";a.setState({searchData:(0,p.default)({},n,{page:e.current,pageSize:e.pageSize,orderField:r,order:u})},function(){a.getList()})},a.handleSubmit=function(e){e.preventDefault();var t=a.props.form,l=a.state.searchData;t.validateFields(function(e,t){if(!e){var n=(0,p.default)({},l,t,{page:1,startTimeFrom:t.startTimeFrom&&t.startTimeFrom.format("YYYY-MM-DD HH:mm:ss"),startTimeTo:t.startTimeTo&&t.startTimeTo.format("YYYY-MM-DD HH:mm:ss"),endTimeFrom:t.endTimeFrom&&t.endTimeFrom.format("YYYY-MM-DD HH:mm:ss"),endTimeTo:t.endTimeTo&&t.endTimeTo.format("YYYY-MM-DD HH:mm:ss")});a.setState({searchData:n},function(){a.getList()})}})},a.postRemark=function(e){var t=a.props,l=t.form,n=t.dispatch;l.validateFields(["remark"],function(t,l){t||n({type:"updateLog/editUpgradeBatch",payload:(0,p.default)({},l,{id:e})}).then(function(e){1===e.code&&a.setState({info:null,groupVisible:!1},function(){a.getList()})})})},a}return(0,T.default)(t,e),(0,b.default)(t,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this,t=this.props,a=t.form,l=a.getFieldDecorator,n=a.getFieldValue,h=t.updateLog,b=t.tableLoading,g=h.tableList,v=h.tablePage,T=this.state,D=T.tabKey,w=T.showMore,y=T.info,Y=T.groupVisible,S={labelCol:{span:6},wrapperCol:{span:14}},x=[{key:"RDB",tab:"RDB\u5347\u7ea7"},{key:"BMU",tab:"BMU\u5347\u7ea7"}],I=[{title:"\u5e8f\u53f7",dataIndex:"batchCode",width:100,render:function(e,t,a){return(v.current-1)*v.pageSize+a+1}},{title:"\u5347\u7ea7\u6279\u6b21",render:function(e,t){return C.default.createElement(O.default,{tooltip:!0,lines:1},t.batchCode)}},{title:"\u5347\u7ea7\u7ed3\u679c",width:200,dataIndex:"description"},{title:"\u8bbe\u5907\u603b\u6570",width:150,dataIndex:"totalNum",sorter:!0},{title:"\u5347\u7ea7\u72b6\u6001",dataIndex:"status",width:100,render:function(e){return Number(e)?C.default.createElement(m.default,{color:"green"},"\u5df2\u5b8c\u6210"):C.default.createElement(m.default,{color:"yellow"},"\u8fdb\u884c\u4e2d")}},{title:"\u5347\u7ea7\u65f6\u95f4",width:200,dataIndex:"startTime",sorter:!0},{title:"\u5b8c\u6210\u65f6\u95f4",width:200,dataIndex:"endTime",render:function(e){return e||"--"}},{title:"\u5907\u6ce8",width:280,dataIndex:"remark",render:function(e){return C.default.createElement(O.default,{tooltip:!0,lines:1},e||"--")}},{title:"\u64cd\u4f5c",fixed:"right",align:"center",width:120,render:function(t,a){return C.default.createElement("span",null,C.default.createElement(k.default,{to:"/update/log/info?batchCode=".concat(a.batchCode,"&version=").concat(encodeURIComponent(a.version),"&type=").concat(a.type)},"\u8be6\u60c5"),C.default.createElement(s.default,{type:"vertical"}),C.default.createElement("a",{onClick:function(){e.setState({info:a,groupVisible:!0})}},"\u5907\u6ce8"))}}],N=n("startTimeFrom"),B=n("startTimeTo"),V=function(e){return B?(0,F.default)(e).valueOf()>=(0,F.default)(B).valueOf():(0,F.default)(e).valueOf()>=(0,F.default)(new Date).valueOf()},z=function(e){return(0,F.default)(e).valueOf()<=(0,F.default)(N).valueOf()},j=n("endTimeFrom"),K=n("endTimeTo"),A=function(e){return K?(0,F.default)(e).valueOf()>=(0,F.default)(K).valueOf():(0,F.default)(e).valueOf()>=(0,F.default)(new Date).valueOf()},P=function(e){return(0,F.default)(e).valueOf()<=(0,F.default)(j).valueOf()};return C.default.createElement(L.default,{tabList:x,tabActiveKey:D,onTabChange:this.handleTabChange},C.default.createElement(r.default,{bordered:!1,bodyStyle:{padding:0}},C.default.createElement(M.default,{layout:"inline",hideRequiredMark:!0,onSubmit:this.handleSubmit},C.default.createElement(H,null,l("rdbsn")(C.default.createElement(c.default,{className:"wd-100",placeholder:"RDB SN"}))),C.default.createElement(H,null,l("batchCode")(C.default.createElement(c.default,{placeholder:"\u5347\u7ea7\u6279\u6b21"}))),C.default.createElement(H,null,l("status")(C.default.createElement(E.default,{className:"wd-100",placeholder:"\u72b6\u6001"},C.default.createElement(R,{value:0},"\u6b63\u5728\u8fdb\u884c"),C.default.createElement(R,{value:1},"\u5df2\u5b8c\u6210")))),C.default.createElement(H,null,C.default.createElement(f.default,{type:"primary",htmlType:"submit"},"\u641c\u7d22")),C.default.createElement(H,null,C.default.createElement(f.default,{onClick:this.handleReset},"\u91cd\u7f6e")),C.default.createElement(H,null,C.default.createElement(f.default,{onClick:function(){e.setState({showMore:!w})}},w?"\u9690\u85cf":"\u66f4\u591a")),C.default.createElement("br",null),w?C.default.createElement("span",null,C.default.createElement(H,null,l("startTimeFrom",{rules:[{type:"object"}]})(C.default.createElement(i.default,{format:"YYYY-MM-DD HH:mm:ss",disabledDate:V,showTime:!0,placeholder:"\u5f00\u59cb\u5347\u7ea7-\u5f00\u59cb\u65f6\u95f4"}))),C.default.createElement("span",{className:"line"},"-"),C.default.createElement(H,null,l("startTimeTo",{rules:[{type:"object"}]})(C.default.createElement(i.default,{format:"YYYY-MM-DD HH:mm:ss",disabledDate:N&&z,showTime:!0,placeholder:"\u5f00\u59cb\u5347\u7ea7-\u7ed3\u675f\u65f6\u95f4"}))),C.default.createElement(H,null,l("endTimeFrom",{rules:[{type:"object"}]})(C.default.createElement(i.default,{format:"YYYY-MM-DD HH:mm:ss",disabledDate:A,showTime:!0,placeholder:"\u5b8c\u6210\u5347\u7ea7-\u5f00\u59cb\u65f6\u95f4"}))),C.default.createElement("span",{className:"line"},"-"),C.default.createElement(H,null,l("endTimeTo",{rules:[{type:"object"}]})(C.default.createElement(i.default,{format:"YYYY-MM-DD HH:mm:ss",disabledDate:j&&P,showTime:!0,placeholder:"\u5b8c\u6210\u5347\u7ea7-\u7ed3\u675f\u65f6\u95f4"})))):""),Y&&C.default.createElement(d.default,{title:"\u5347\u7ea7\u5907\u6ce8",visible:Y,onOk:function(){return e.postRemark(y&&y.id)},onCancel:function(){e.setState({info:null,groupVisible:!1})},destroyOnClose:!0},C.default.createElement(M.default,null,C.default.createElement(H,(0,o.default)({},S,{label:"\u5347\u7ea7\u5907\u6ce8"}),l("remark",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8be5\u6279\u6b21\u5347\u7ea7\u5907\u6ce8"}],initialValue:y&&y.remark})(C.default.createElement(c.default,{placeholder:"\u8bf7\u8f93\u5165\u8be5\u6279\u6b21\u5347\u7ea7\u5907\u6ce8"}))))),C.default.createElement(u.default,{className:"mt-20",rowKey:function(e){return e.batchCode},dataSource:g,pagination:(0,p.default)({},v,{showSizeChanger:!0,showQuickJumper:!0,showTotal:this.showTotal}),columns:I,onChange:this.handleTableChange,loading:b,scroll:{x:1500,y:500}})))}}]),t}(C.PureComponent),y=Y))||y)||y),I=x;t.default=I}}]);